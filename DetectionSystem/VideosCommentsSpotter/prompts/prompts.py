#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Videos Comments Spotter - 提示词模板

此文件包含所有LLM调用所需的提示词模板，用于：
1. 关键词生成
2. 内容分析与风险评估
3. 报告生成

每个提示词都经过精心设计，以确保高质量的模型输出。
"""

# 关键词生成提示词 - 用于从话题生成有效的搜索关键词和爬取策略
VCS_KEYWORD_PROMPT = """
你是一个专业的舆情分析搜索策略专家，擅长从给定话题中提取最具搜索价值的关键词，并制定最优的爬取策略。

请基于以下风险话题，生成3-5个最相关、最精准的搜索关键词，并为每个关键词单独指定合适的爬取参数：

风险话题: {risk_topic}

【核心要求 - 必须严格遵守】：
1. **严格基于原话题**：关键词必须直接来自风险话题的核心内容，或者是话题的核心组成部分
2. **高度相关性**：每个关键词都必须与风险话题高度相关，不能是无关或弱相关的扩展词汇
3. **避免幻觉**：不得生成话题中未提及的词汇，不得添加任何推测性内容
4. **精准提取**：优先提取话题中的核心实体、关键事件、主要对象等具体词汇
5. **简洁明确**：关键词应当简洁明确，通常为2-5个字，避免过长或过短

【关键词生成规则】：
1. 如果话题包含具体的人名、地名、产品名、事件名，优先使用这些作为关键词
2. 如果话题包含核心概念或关键动作，提取这些作为关键词
3. 避免使用通用词汇（如"问题"、"事件"、"情况"等）
4. 避免使用测试词汇或示例词汇
5. 避免包含标点符号和特殊字符
6. 关键词数量控制在3-5个，确保每个关键词都具有高度相关性

【爬取参数设置】：
- 爬取平台固定为：dy（抖音）
- 每个关键词最多爬取5个视频/帖子（max_video_count）
- 每个视频/帖子最多爬取15条评论（max_comment_count）
- 所有关键词的爬取数量总和不能超过20个视频
- 最大重试次数：3次

请严格按照JSON格式输出结果，包含以下字段：
- "keywords_config": [
    {"keyword": "关键词1（必须来自原话题）", "max_video_count": 数字, "max_comment_count": 数字},
    {"keyword": "关键词2（必须来自原话题）", "max_video_count": 数字, "max_comment_count": 数字},
    ...
  ] （生成的关键词列表及其爬取参数，关键词必须与原话题高度相关）
- "platforms": ["dy"] （固定爬取平台）
- "max_retries": 3 （最大重试次数）

【输出要求】：
- 确保JSON格式正确，不包含任何额外的文本或解释
- 所有关键词必须能够从原话题中直接提取或推导，不能是无关词汇
- 如果无法从话题中提取足够的关键词，可以减少关键词数量，但必须保证质量
"""

# 内容分析提示词 - 用于分析爬取的视频和评论内容
VCS_ANALYSIS_PROMPT = """
你是一个专业的内容分析专家，擅长识别媒体内容中的风险信息和关键趋势。

请分析以下从社交媒体平台爬取的视频和评论内容，重点关注与话题相关的信息。

【核心原则 - 必须严格遵守】：
1. **严格基于事实**：只分析爬取内容中明确出现的信息，不得添加任何未提及的内容
2. **避免幻觉**：不得推测、想象或添加任何未在爬取内容中出现的信息
3. **提高风险阈值**：只将真正存在风险的内容标记为风险，避免过度敏感
4. **证据导向**：每个判断必须有明确的证据支持，不能仅凭主观推测
5. **客观中立**：提供客观、中立的分析，避免个人偏见和情绪化判断

## 话题信息：
{topic_info}

## 爬取内容：
{content}

## 分析要求：
1. **识别主要观点**：基于爬取内容中的实际文本，识别主要观点、情感倾向和讨论焦点
2. **评估信息可靠性**：基于内容的来源、一致性等因素评估信息可靠性
3. **分析风险等级**：基于实际内容中的负面倾向、争议程度等评估风险等级
4. **总结关键发现**：只总结爬取内容中实际出现的关键信息，不得添加未提及的内容
5. **提供建议**：基于实际分析结果提供具体、可操作的建议

## 风险等级判断标准：
- **极高**：内容明确显示严重负面事件、重大安全隐患、群体冲突等，且有大量负面评论
- **高**：内容显示明显的负面倾向、争议或潜在风险，负面评论占比较高
- **中**：内容可能引发讨论或争议，但负面倾向不明确，需要进一步观察
- **低**：内容基本中性或正面，无明显负面倾向或风险

## 输出格式：
请以JSON格式输出分析结果，包含以下字段：
- "risk_level": "低" | "中" | "高" | "极高" (风险等级评估，必须基于实际内容)
- "key_findings": ["发现1（必须来自实际内容）", "发现2", ...] (关键发现列表，不得添加未提及的内容)
- "sentiment_analysis": {"positive": 0.0, "negative": 0.0, "neutral": 0.0} (情感分析比例，基于实际内容统计)
- "main_topics": ["主题1（必须来自实际内容）", "主题2", ...] (主要讨论主题，不得添加未提及的主题)
- "reliability": "高" | "中" | "低" (信息可靠性评估，基于内容来源和一致性)
- "summary": "详细的分析总结文本（必须基于实际内容，不得添加未提及的信息）" (详细分析总结)
- "recommendations": ["建议1（基于实际分析结果）", "建议2", ...] (后续行动建议)

【输出要求】：
- 确保JSON格式正确，不包含任何额外的文本或解释
- 所有分析结果必须严格基于爬取内容，不得添加任何未提及的信息
- 如果爬取内容中没有明显的风险信息，risk_level应为"低"
- key_findings和main_topics必须来自实际内容，不得是推测或想象
"""

# 错误报告生成提示词
VCS_ERROR_REPORT_PROMPT = """
请生成一个标准化的错误报告，基于以下错误信息：

## 错误详情：
{error_details}

## 操作上下文：
{operation_context}

## 输出格式：
请以JSON格式输出错误报告，包含以下字段：
- "error_type": "错误类型描述"
- "error_message": "具体错误信息"
- "timestamp": "当前时间戳"
- "operation": "执行的操作"
- "severity": "错误严重性：低/中/高"
- "possible_causes": ["可能原因1", "可能原因2", ...]
- "recommended_actions": ["建议操作1", "建议操作2", ...]

请确保JSON格式正确，内容客观准确。
"""

# 结果摘要生成提示词 - 用于生成简洁的爬取结果摘要
VCS_SUMMARY_PROMPT = """
请基于以下爬取结果，生成一个简洁明了的摘要：

## 爬取信息：
- 话题：{topic}
- 平台：{platforms}
- 爬取数量：内容 {content_count} 条，评论 {comment_count} 条
- 执行时间：{execution_time} 秒

## 关键内容：
{key_content}

请生成一段200字以内的摘要，突出最重要的发现和趋势。
"""

# 关键词优化提示词 - 用于改进初始生成的关键词
VCS_KEYWORD_OPTIMIZATION_PROMPT = """
请优化以下初始关键词列表，使其更适合在社交媒体平台上搜索：

初始关键词：
{keywords}

优化要求：
1. 扩展相关同义词和变体
2. 添加热门搜索词和网络用语
3. 删除过于生僻或不相关的词汇
4. 考虑搜索算法的匹配机制
5. 针对不同平台的特性进行调整

请输出优化后的关键词列表，每个关键词一行。
"""
